<%namespace name='static' file='static_content.html'/>
<%! from django.utils import html %>
<%! from django.utils.translation import ugettext as _ %>

## Define a couple of helper functions to make life easier when
## embedding theme conditionals into templates. All inheriting
## templates have access to these functions, and we can import these
## into non-inheriting templates via the %namespace tag.
<%def name="theme_enabled()">
  <% return settings.MITX_FEATURES["USE_CUSTOM_THEME"] %>
</%def>

<%def name="stanford_theme_enabled()">
  <% return theme_enabled() and getattr(settings, "THEME_NAME") == "stanford" %>
</%def>

<!DOCTYPE html>
<html>
<head>
  <%block name="title">
    % if stanford_theme_enabled():
      <title>${_("Home")} | class.stanford.edu</title>
    % else:
      ## "edX" should not be translated
      <title>edX</title>

      <script type="text/javascript">
        /* immediately break out of an iframe if coming from the marketing website */
        (function(window) {
          if (window.location !== window.top.location) {
            window.top.location = window.location;
          }
        })(this);
      </script>
    % endif
  </%block>

  <script type="text/javascript" src="/i18n.js"></script>

  <link rel="icon" type="image/x-icon" href="${static.url(settings.FAVICON_PATH)}" />

  <%static:css group='application'/>

  <%static:js group='main_vendor'/>
  <%block name="headextra"/>
  % if theme_enabled():
    <%include file="theme-head-extra.html" />
  % endif

  <!--[if lt IE 9]>
  <script src="${static.url('js/html5shiv.js')}"></script>
  <![endif]-->

  <!--[if lte IE 9]>
  <%static:css group='ie-fixes'/>
  <![endif]-->
  <meta name="path_prefix" content="${MITX_ROOT_URL}">
  <meta name="google-site-verification" content="_mipQ4AtZQDNmbtOkwehQDOgCxUUV2fb_C0b6wbiRHY" />

  % if not course:
    % if theme_enabled():
      <%include file="theme-google-analytics.html" />
    % else:
      <%include file="google_analytics.html" />
    % endif
  % endif

  <%include file="widgets/segment-io.html" />

</head>

<body class="<%block name='bodyclass'/>">

% if theme_enabled():
  <%include file="theme-header.html" />
% elif not suppress_toplevel_navigation:
  <%include file="navigation.html" />
% endif

  <section class="content-wrapper">
    ${self.body()}
    <%block name="bodyextra"/>
  </section>

% if theme_enabled():
  <%include file="theme-footer.html" />
% elif not suppress_toplevel_navigation:
  <%include file="footer.html" />
% endif

<script type="text/javascript">
var require = {
    baseUrl: "/static",
    paths: {
        "gettext": "/i18n",
        "mustache": "js/vendor/mustache",
        "codemirror": "js/vendor/codemirror-compressed",
        "jquery": "js/vendor/jquery.min",
        "jquery.ui": "js/vendor/jquery-ui.min",
        "jquery.form": "js/vendor/jquery.form",
        "jquery.markitup": "js/vendor/markitup/jquery.markitup",
        "jquery.leanmodal": "js/vendor/jquery.leanModal.min",
        "jquery.smoothscroll": "js/vendor/jquery.smooth-scroll.min",
        "jquery.timepicker": "js/vendor/timepicker/jquery.timepicker",
        "jquery.cookie": "js/vendor/jquery.cookie",
        "jquery.qtip": "js/vendor/jquery.qtip.min",
        "jquery.fileupload": "js/vendor/jQuery-File-Upload/js/jquery.fileupload",
        "jquery.iframe-transport": "js/vendor/jQuery-File-Upload/js/jquery.iframe-transport",
        "jquery.inputnumber": "js/vendor/html5-input-polyfills/number-polyfill",
        "jquery.myhtmlviewer": "js/jquery.myhtmlviewer",
        "flot": "js/vendor/flot/jquery.flot",
        "datepair": "js/vendor/timepicker/datepair",
        "date": "js/vendor/date",
        "underscore": "js/vendor/underscore-min",
        "underscore.string": "js/vendor/underscore.string.min",
        "backbone": "js/vendor/backbone-min",
        "backbone.associations": "js/vendor/backbone-associations-min",
        "youtube": "js/load_youtube",
        "tinymce": "js/vendor/tiny_mce/tiny_mce",
        "jquery.tinymce": "js/vendor/tiny_mce/jquery.tinymce",
        "mathjax": "https://edx-static.s3.amazonaws.com/mathjax-MathJax-727332c/MathJax.js?config=TeX-MML-AM_HTMLorMML-full",
        "mersenne": "js/vendor/mersenne-twister-min",
        "xmodule": "/xmodule/xmodule",
        "utility": "js/src/utility"
    },
    shim: {
        "gettext": {
            exports: "gettext"
        },
        "date": {
            exports: "Date"
        },
        "jquery.ui": {
            deps: ["jquery"],
            exports: "jQuery.ui"
        },
        "jquery.form": {
            deps: ["jquery"],
            exports: "jQuery.fn.ajaxForm"
        },
        "jquery.markitup": {
            deps: ["jquery"],
            exports: "jQuery.fn.markitup"
        },
        "jquery.leanmodal": {
            deps: ["jquery"],
            exports: "jQuery.fn.leanModal"
        },
        "jquery.smoothscroll": {
            deps: ["jquery"],
            exports: "jQuery.fn.smoothscroll"
        },
        "jquery.cookie": {
            deps: ["jquery"],
            exports: "jQuery.fn.cookie"
        },
        "jquery.qtip": {
            deps: ["jquery"],
            exports: "jQuery.fn.qtip"
        },
        "jquery.fileupload": {
            deps: ["jquery.iframe-transport"],
            exports: "jQuery.fn.fileupload"
        },
        "jquery.inputnumber": {
            deps: ["jquery"],
            exports: "jQuery.fn.inputNumber"
        },
        "jquery.tinymce": {
            deps: ["jquery", "tinymce"],
            exports: "jQuery.fn.tinymce"
        },
        "datepair": {
            deps: ["jquery.ui", "jquery.timepicker"]
        },
        "underscore": {
            exports: "_"
        },
        "backbone": {
            deps: ["underscore", "jquery"],
            exports: "Backbone"
        },
        "backbone.associations": {
            deps: ["backbone"],
            exports: "Backbone.Associations"
        },
        "codemirror": {
            exports: "CodeMirror"
        },
        "tinymce": {
            exports: "tinymce"
        },
        "mathjax": {
            exports: "MathJax"
        },
        "mersenne": {
            exports: "MersenneTwister"
        }
    }
};
</script>
<script type="text/javascript" src="/static/js/vendor/require.js"></script>
<script type="text/javascript">
require(["jquery", "js/form.ext"],
  function($) {
    if(!window.$) {
      window.$ = $;
    }
    window.RequireJS = {
        'requirejs': requirejs,
        'require': require,
        'define': define
    };
  }
);
</script>

  <%static:js group='application'/>
  <%static:js group='module-js'/>

  <%block name="js_extra"/>
</body>
</html>

<%def name="login_query()">${
  "?course_id={0}&enrollment_action={1}".format(
    html.escape(course_id),
    html.escape(enrollment_action)
  ) if course_id and enrollment_action else ""
}</%def>
